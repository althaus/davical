<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>Docs for page caldav-PUT-functions.php</title>
			<link rel="stylesheet" href="../../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
			<div class="page-body">			
<h2 class="file-name"><img src="../../media/images/Page_logo.png" alt="File" style="vertical-align: middle">/inc/caldav-PUT-functions.php</h2>

<a name="sec-description"></a>
<div class="info-box">
	<div class="info-box-title">Description</div>
	<div class="nav-bar">
					<span class="disabled">Description</span> |
									<a href="#sec-includes">Includes</a>
			|											<a href="#sec-functions">Functions</a>
			</div>
	<div class="info-box-body">	
		<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">CalDAV Server - handle PUT method</p>
	<ul class="tags">
				<li><span class="field">author:</span> Andrew McMillan &lt;<a href="mailto:andrew@morphoss.com">andrew@morphoss.com</a>&gt;</li>
				<li><span class="field">copyright:</span> Morphoss Ltd - http://www.morphoss.com/</li>
				<li><span class="field">license:</span> <a href="http://gnu.org/copyleft/gpl.html">GNU GPL v2 or later version</a></li>
			</ul>
		
			</div>
</div>
		

	<a name="sec-includes"></a>	
	<div class="info-box">
		<div class="info-box-title">Includes</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
						<span class="disabled">Includes</span>
			|													<a href="#sec-functions">Functions</a>
					</div>
		<div class="info-box-body">	
			<a name="_vCalendar_php"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name">'vCalendar.php'</span>)
			(line <span class="line-number">20</span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	
</div>
<a name="_vComponent_php"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name">'vComponent.php'</span>)
			(line <span class="line-number">19</span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	
</div>
<a name="_WritableCollection_php"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name"><a href="../../davical/_inc---WritableCollection.php.html">'WritableCollection.php'</a></span>)
			(line <span class="line-number">21</span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	
</div>
<a name="_AwlCache_php"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name">'AwlCache.php'</span>)
			(line <span class="line-number">18</span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Check if the user wants to put just one VEVENT/VTODO or a whole calendar</p>
<p class="description"><p>if the collection = calendar = $request_container doesn't exist then create it  return true if it's a whole calendar</p></p>
	
</div>
		</div>
	</div>
	
	
	
	<a name="sec-functions"></a>	
	<div class="info-box">
		<div class="info-box-title">Functions</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
										<a href="#sec-includes">Includes</a>
				|												<span class="disabled">Functions</span>
		</div>
		<div class="info-box-body">	
			<a name="functioncontrolRequestContainer" id="functioncontrolRequestContainer"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">controlRequestContainer</span> (line <span class="line-number">69</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Work out the location we are doing the PUT to, and check that we have the rights to  do the needful.</p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			controlRequestContainer
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$username</span>, <span class="var-type">int</span>&nbsp;<span class="var-name">$user_no</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>, <span class="var-type">boolean</span>&nbsp;<span class="var-name">$caldav_context</span>, [<span class="var-type">boolean</span>&nbsp;<span class="var-name">$public</span> = <span class="var-default">null</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$username</span><span class="var-description">: The name of the destination user</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$user_no</span><span class="var-description">: The user making the change</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span><span class="var-description">: The DAV path the resource is bing PUT to</span>			</li>
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$caldav_context</span><span class="var-description">: Whether we are responding via CalDAV or interactively</span>			</li>
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$public</span><span class="var-description">: Whether the collection will be public, should we need to create it</span>			</li>
				</ul>
		
	
</div>
<a name="functiondo_scheduling_reply" id="functiondo_scheduling_reply"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">do_scheduling_reply</span> (line <span class="line-number">319</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Do the scheduling adjustments for a REPLY when an ATTENDEE updates their status.</p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			do_scheduling_reply
		</span>
					(<span class="var-type"></span>&nbsp;<span class="var-name">$resource</span>, <span class="var-type"></span>&nbsp;<span class="var-name">$organizer</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">vCalendar</span>
				<span class="var-name">$resource</span><span class="var-description">: The resource that the ATTENDEE is writing to their calendar</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$organizer</span><span class="var-description">: The property which is the event ORGANIZER.</span>			</li>
				</ul>
		
	
</div>
<a name="functiondo_scheduling_requests" id="functiondo_scheduling_requests"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">do_scheduling_requests</span> (line <span class="line-number">447</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Create/Update the scheduling requests for this resource.  This includes updating  the scheduled user's default calendar.</p>
	<ul class="tags">
				<li><span class="field">return:</span> If there was any scheduling action</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">true</span>
		<span class="method-name">
			do_scheduling_requests
		</span>
					(<span class="var-type"></span>&nbsp;<span class="var-name">$resource</span>, <span class="var-type">boolean</span>&nbsp;<span class="var-name">$create</span>, [<span class="var-type"></span>&nbsp;<span class="var-name">$old_data</span> = <span class="var-default">null</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">vComponent</span>
				<span class="var-name">$resource</span><span class="var-description">: The VEVENT/VTODO/... resource we are scheduling</span>			</li>
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$create</span><span class="var-description">: true if the scheduling requests are being created.</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$old_data</span>			</li>
				</ul>
		
	
</div>
<a name="functionGetTZID" id="functionGetTZID"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">GetTZID</span> (line <span class="line-number">168</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Get a TZID string from this VEVENT/VTODO/... component if we can</p>
	<ul class="tags">
				<li><span class="field">return:</span> TZID value we found, or null</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">The</span>
		<span class="method-name">
			GetTZID
		</span>
					(<span class="var-type"></span>&nbsp;<span class="var-name">$comp</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">vComponent</span>
				<span class="var-name">$comp</span>			</li>
				</ul>
		
	
</div>
<a name="functionhandle_schedule_reply" id="functionhandle_schedule_reply"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">handle_schedule_reply</span> (line <span class="line-number">270</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Deliver scheduling replies to organizer and other attendees</p>
	<ul class="tags">
				<li><span class="field">return:</span> on error</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">false</span>
		<span class="method-name">
			handle_schedule_reply
		</span>
					(<span class="var-type"></span>&nbsp;<span class="var-name">$ical</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">vComponent</span>
				<span class="var-name">$ical</span><span class="var-description">: the VCALENDAR to deliver</span>			</li>
				</ul>
		
	
</div>
<a name="functionhandle_schedule_request" id="functionhandle_schedule_request"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">handle_schedule_request</span> (line <span class="line-number">181</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Deliver scheduling requests to attendees</p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			handle_schedule_request
		</span>
					(<span class="var-type">vComponent</span>&nbsp;<span class="var-name">$ical</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">vComponent</span>
				<span class="var-name">$ical</span><span class="var-description">: the VCALENDAR to deliver</span>			</li>
				</ul>
		
	
</div>
<a name="functionimport_collection" id="functionimport_collection"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">import_collection</span> (line <span class="line-number">561</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This function will import a whole calendar</p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			import_collection
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$ics_content</span>, <span class="var-type">int</span>&nbsp;<span class="var-name">$user_no</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>, <span class="var-type">boolean</span>&nbsp;<span class="var-name">$caldav_context</span>, [<span class="var-type"></span>&nbsp;<span class="var-name">$appending</span> = <span class="var-default">false</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$ics_content</span><span class="var-description">: the ics file to import</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$user_no</span><span class="var-description">: the user wich will receive this ics file</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span><span class="var-description">: the $path where it will be store such as /user_foo/home/</span>			</li>
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$caldav_context</span><span class="var-description">: <p>Whether we are responding via CalDAV or interactively</p><p>Any VEVENTs with the same UID will be concatenated together</p></span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$appending</span>			</li>
				</ul>
		
	
</div>
<a name="functionpublic_events_only" id="functionpublic_events_only"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">public_events_only</span> (line <span class="line-number">144</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Check if this collection should force all events to be PUBLIC.</p>
	<ul class="tags">
				<li><span class="field">return:</span> Return true if public events only are allowed.</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">boolean</span>
		<span class="method-name">
			public_events_only
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$user_no</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$dav_name</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$user_no</span><span class="var-description">: the user that owns the collection</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$dav_name</span><span class="var-description">: the collection to check</span>			</li>
				</ul>
		
	
</div>
<a name="functionrollback_on_error" id="functionrollback_on_error"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">rollback_on_error</span> (line <span class="line-number">38</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This function launches an error</p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			rollback_on_error
		</span>
					(<span class="var-type">boolean</span>&nbsp;<span class="var-name">$caldav_context</span>, <span class="var-type">int</span>&nbsp;<span class="var-name">$user_no</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>, [<span class="var-type">string</span>&nbsp;<span class="var-name">$message</span> = <span class="var-default">&#039;&#039;</span>], [<span class="var-type">int</span>&nbsp;<span class="var-name">$error_no</span> = <span class="var-default">500</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$caldav_context</span><span class="var-description">: Whether we are responding via CalDAV or interactively</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$user_no</span><span class="var-description">: the user who will receive this ics file</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span><span class="var-description">: the $path where the PUT failed to store such as /user_foo/home/</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$message</span><span class="var-description">: An optional error message to return to the client</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$error_no</span><span class="var-description">: An optional value for the HTTP error code</span>			</li>
				</ul>
		
	
</div>
<a name="functionsimple_write_resource" id="functionsimple_write_resource"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">simple_write_resource</span> (line <span class="line-number">1187</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">A slightly simpler version of write_resource which will make more sense for calling from  an external program.  This makes assumptions that the collection and user do exist  and bypasses all checks for whether it is reasonable to write this here.</p>
	<ul class="tags">
				<li><span class="field">return:</span> True for success, false for failure.</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">boolean</span>
		<span class="method-name">
			simple_write_resource
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$caldav_data</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$put_action_type</span>, [<span class="var-type"></span>&nbsp;<span class="var-name">$write_action_log</span> = <span class="var-default">false</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span><span class="var-description">: The path to the resource being written</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$caldav_data</span><span class="var-description">: The actual resource to be written</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$put_action_type</span><span class="var-description">: INSERT or UPDATE depending on what we are to do</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$write_action_log</span>			</li>
				</ul>
		
	
</div>
<a name="functionwrite_alarms" id="functionwrite_alarms"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">write_alarms</span> (line <span class="line-number">796</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Given a dav_id and an original vCalendar, pull out each of the VALARMs  and write the values into the calendar_alarm table.</p>
	<div class="method-signature">
		<span class="method-result">null</span>
		<span class="method-name">
			write_alarms
		</span>
					(<span class="var-type">int</span>&nbsp;<span class="var-name">$dav_id</span>, <span class="var-type"></span>&nbsp;<span class="var-name">$ical</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$dav_id</span><span class="var-description">: The dav_id of the caldav_data we're processing</span>			</li>
					<li>
				<span class="var-type">vComponent</span>
				<span class="var-name">$ical</span><span class="var-description">: The VEVENT or VTODO containing the VALARM</span>			</li>
				</ul>
		
	
</div>
<a name="functionwrite_attendees" id="functionwrite_attendees"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">write_attendees</span> (line <span class="line-number">853</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Parse out the attendee property and write a row to the  calendar_attendee table for each one.</p>
	<div class="method-signature">
		<span class="method-result">null</span>
		<span class="method-name">
			write_attendees
		</span>
					(<span class="var-type">int</span>&nbsp;<span class="var-name">$dav_id</span>, <span class="var-type"></span>&nbsp;<span class="var-name">$ical</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$dav_id</span><span class="var-description">: The dav_id of the caldav_data we're processing</span>			</li>
					<li>
				<span class="var-type">vComponent</span>
				<span class="var-name">$ical</span><span class="var-description">: The VEVENT or VTODO containing the ATTENDEEs</span>			</li>
				</ul>
		
	
</div>
<a name="functionwrite_resource" id="functionwrite_resource"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">write_resource</span> (line <span class="line-number">902</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Actually write the resource to the database.  All checking of whether this is reasonable  should be done before this is called.</p>
	<ul class="tags">
				<li><span class="field">return:</span> True for success, false for failure.</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">boolean</span>
		<span class="method-name">
			write_resource
		</span>
					(<span class="var-type"><a href="../../davical/Resource/DAVResource.html">DAVResource</a></span>&nbsp;<span class="var-name">$resource</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$caldav_data</span>, <span class="var-type"><a href="../../davical/Resource/DAVResource.html">DAVResource</a></span>&nbsp;<span class="var-name">$collection</span>, <span class="var-type">int</span>&nbsp;<span class="var-name">$author</span>, <span class="var-type"></span>&nbsp;<span class="var-name">&$etag</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$put_action_type</span>, <span class="var-type">boolean</span>&nbsp;<span class="var-name">$caldav_context</span>, [<span class="var-type">string</span>&nbsp;<span class="var-name">$log_action</span> = <span class="var-default">true</span>], [<span class="var-type">string</span>&nbsp;<span class="var-name">$weak_etag</span> = <span class="var-default">null</span>], <span class="var-type">string</span>&nbsp;<span class="var-name">$etag</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type"><a href="../../davical/Resource/DAVResource.html">DAVResource</a></span>
				<span class="var-name">$resource</span><span class="var-description">: The resource being written</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$caldav_data</span><span class="var-description">: The actual data to be written</span>			</li>
					<li>
				<span class="var-type"><a href="../../davical/Resource/DAVResource.html">DAVResource</a></span>
				<span class="var-name">$collection</span><span class="var-description">: The collection containing the resource being written</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$author</span><span class="var-description">: The user_no who wants to put this resource on the server</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$etag</span><span class="var-description">: An etag unique for this event</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$put_action_type</span><span class="var-description">: INSERT or UPDATE depending on what we are to do</span>			</li>
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$caldav_context</span><span class="var-description">: True, if we are responding via CalDAV, false for other ways of calling this</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$log_action</span><span class="var-description">: Either 'INSERT' or 'UPDATE': the type of action we are doing</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$weak_etag</span><span class="var-description">: An etag that is NOT modified on ATTENDEE changes for this event</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">&$etag</span>			</li>
				</ul>
		
	
</div>
		</div>
	</div>
	
	<p class="notes" id="credit">
		Documentation generated on Wed, 04 Jan 2012 16:20:17 +1300 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.4.3</a>
	</p>
	</div></body>
</html>